<!DOCTYPE html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="apple-mobile-web-app-title">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">

	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-touch-fullscreen" content="yes">
	<meta name="description">

	<title>Create Emoji Character</title>

	<style type="text/css">

		label{
			width: 150px;
			display: inline-block;
		}

		.object-type, .object{

			width: 100px;
			display: inline-block;
		}

		.selected-emoji{

			width: 400px;
			height: 200px;

			line-height: 200px;

			font-size: 100px;

			text-align: center;

			margin: 0 auto;

			border: gray 1px solid;

		}
	</style>
</head>
<body>
	<div>
		<label name="object-type-label">OBJECT TYPE</label><select class="object-type"></select>
	</div>
	<div>
		<label name="object-label">OBJECT</label><select class="object"></select>
	</div>

	<div class="selected-emoji"></div>

	<script type="text/javascript">

		const objectTypeElem = document.querySelector('.object-type');
		const objectElem = document.querySelector('.object');
		const selectedEmoji = document.querySelector('.selected-emoji');

		// 이모지 객체 타입 셀렉트 박스를 생성한다.
		createObjectTypeOptions();

		// 객체 타입 옵션을 생성한다.
		function createObjectTypeOptions(){

			removeOptions(objectTypeElem);

			const objectTypes = EmojiJoin.getObjectTypes();

			objectTypes.forEach(v => {

				const objectCode = v.objectCode;
				const objectCodeName = v.objectCodeName;
				const entities = v.entities;

				var option = document.createElement('option');


				if (entities){
					option.innerHTML = `${entities}\(${objectCodeName})`;
				}
				else{
					option.text = `${objectCodeName}`;
				}

				option.value = objectCode;

				objectTypeElem.add(option);
			});

			createObjectOptions(objectTypes[0].objectCode);

			objectTypeElem.onchange = e => {

				const currentTarget = e.currentTarget;
				const objectCode = currentTarget.value;

				removeOptions(objectElem);
				createObjectOptions(objectCode);
			};
		}

		// 객체 옵션을 생성한다.
		function createObjectOptions(objectCode = ''){

			removeOptions(objectElem);

			const objects = EmojiJoin.getObjects(objectCode);

			objects.forEach(v => {

				const objectFullName = v.objectFullName;
				const entities = v.entities;

				var option = document.createElement('option');

				if (entities){
					option.innerHTML = `${entities}(${objectFullName})`;
				}
				else{
					option.text = objectFullName;
				}

				option.value = entities;

				objectElem.add(option);
			});

			selectedEmoji.innerHTML = objects[0].entities;

			objectElem.onchange = e => {

				const currentTarget = e.currentTarget;
				const entities = currentTarget.value;

				selectedEmoji.innerHTML = entities;
			};
		}

		// 셀렉트 박스 옵션을 삭제한다.
		function removeOptions(elem = null, index = null){

			if (index){
				elem.remove(index);
			}
			else{
				elem.innerHTML = '';
			}
		}


	</script>
</body>
</html>
